---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# SAT

<!-- badges: start -->
<!-- badges: end -->

The goal of SAT is to ...

Pre-request package: plink 


## Installation

You can install the development version from [GitHub](https://github.com/) with:

```{r}
# install.packages("devtools")
devtools::install_github("JianqiaoWang/SAT")
```


One may also need to install PLINK for block identification, and prepare a suitable reference dataset for the input of the p-value sequence. One commom resource of the reference dataset of the European population for clumping, which is also used in the GRAPPLE paper, is the 1000 genome European reference panel downloaded here http://fileserve.mrcieu.ac.uk/ld/data_maf0.01_rs_ref.tgz, from the MRCIEU cite.

## Example

This is a basic example which shows you how to solve a common problem: Independent sequence

```{r example}
library(SAT)
## basic example code
p <- 1*10^5; ## total number of pairs
d1 = 100; d2 = 100; d3 = 1;
X <- c(rep(0,p-(d1 + d2 + d3)),rep(1,d1),rep(2,d2),rep(3,d3));
mu.1 = rep(0, p); mu.2 = rep(0, p);
mu.1[X==1|X==3] = 4; mu.2[X==2|X==3] = 5;
Z1 <- mu.1 + rnorm(p,0,1);
Z2 <- mu.2 + rnorm(p,0,1);
T1 = abs(Z1);T2 = abs(Z2);
P1 = 2* (1 - pnorm( T1)); P2 = 2* (1 - pnorm(T2));
MinMaxP.simu(P1, P2)
```

For the typical genetic applications, we consider the LD between the sequences. It requires the additional information of the external LD matrix.  

```{r, eval = F}
pvalue =  SAT::MinMaxP.geno(sumstat.comb$P.gwas, sumstat.comb$P.gtex, ref.geno = geno, ref.bed = "../geno/GTEx_WGS_838Indiv_Freeze_phased_MAF_0.01_chr1_22_EU",
                            output.dir = output.dir, var.name = sumstat.comb$variant_id, block.thresh = 0.99)

```
